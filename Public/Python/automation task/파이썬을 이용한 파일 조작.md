# 업무자동화

## 파이썬을 이용한 파일 조작하기

### 파일 생성 및 수정

```python
# 파일을 오픈한다. 이 떄, 'w'가 붙어있다면 수정모드로 오픈, 만약 filename이 없다면 해당 file을 생성한다.
outfile = open("filename.txt", 'w')

# 오픈한 파일에 글을 작성한다.
outfile.write("name : test")

# 오픈된 파일을 닫고 저장한다.
outfile.close()
```

### os

```python
import os

# 현재 디렉토리에서 test라는 이름의 폴더를 생성
os.mkdir("test");

# test라는 이름의 폴더를 찾아서 그 폴더 안의 내용물을 리스팅하는 것
os.listdir("test");
```

## CSV

> Comma-Separated Varables

- CSV는 `,`로 나누어진 변수들로 다음 표를 csv로 표기한다면

<img src="파이썬을 이용한 파일 조작.assets/스크린샷 2021-07-06 오후 4.36.33.png" alt="스크린샷 2021-07-06 오후 4.36.33" style="zoom: 25%;" />

```
이름, 나이, 직업, 성별
반병현, 28, 농부, 남성
김철수, 14, 학생, 여성
```

이와 같이 csv에서 표의 열 구분은 `,`로 행 구분은 `enter`로 한다.



## Pyexcel

- CSV to Excel을 하기 위해서는 pyexcel을 설치해야한다.

  ```bash
  pip3 install pyexcel pyexcel-xlsx
  ```



- 윈도우 오피스는 `EUC-KR`의 인코딩 방식을 선호한다. 하지만, 파이써썬은 `UTF-8`의 방식을 선호함 
  따라서 csv를 python의 pyexcel을 이용하여 변환을 하려면 `EUC-KR`의 CSV를 `UTF-8`의 방식으로 변환해줘야 한다.

  ```python
  # 터미널에서 입력받은 값
  python3 test.py first second
  
  # sys.argv[0] = test.csv
  # sys.argv[1] = first
  # sys.argv[2] = second
  
  -> python3 change.py test.csv
  
  # change.py
  
  filename = sys.argv[1] # test.csv
  
  in_file = open(filename, encoading="euc-kr") # euc-kr방식의 csv를 euc-kr방식으로 읽는다.
  out_file = open(filename + '2', 'w', encoading="utf-8") # utf-8방식의 파일을 만든다.
  
  content = in_file.read() # euc-kr 방식의 파일을 가져온다.
  out_file.write(content) # utf-8방식에 euc-kr 방식의 파일을 적는다.
  
  in_file.close()
  out_file.close()
  ```

  

### Array to excel

- CSV는 콤마와 엔터를 통해 테이블을 구성했다면 pyexcel에서 바로 표형식으로 만들어 주기 위해서는 2차원 배열이 필요하다.

- 사용법

  ```python
  import pyexcel as px
  
  myArray = [['a', 'b', 'c'], [1,2,3], [4,5,6]]
  
  # array는 content로 표시할 배열
  # dest_file_name은 저장할 파일 이름
  px.save_as(array=myArray, dest_file_name="test.xlsx")
  ```

  







